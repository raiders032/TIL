# 1 CloudTrail

- AWS CloudTrail은 AWS 계정의 운영 및 위험 감사, 거버넌스, 규정 준수를 활성화하는 데 도움이 되는 서비스입니다.
- 사용자, 역할 또는 AWS 서비스에 의해 수행된 작업은 CloudTrail 이벤트로 기록됩니다.
- 이러한 이벤트에는 AWS Management Console, AWS Command Line Interface, AWS SDK 및 API에서 수행된 작업이 포함됩니다.
- CloudTrail은 AWS account를 생성할 때 자동으로 활성화됩니다.
- AWS 계정에서 활동이 발생하면 해당 활동은 CloudTrail 이벤트에 기록됩니다.

<br>

# 2 이벤트 기록 방식

- CloudTrail은 이벤트를 기록하기 위해 세 가지 방법을 제공합니다:

<br>

## 2.1 이벤트 히스토리

- 이벤트 히스토리는 AWS 리전에서 지난 90일간의 관리 이벤트에 대한 조회 가능하고, 검색 가능하며, 다운로드 가능하고, 불변의 기록을 제공합니다.
- 단일 속성으로 필터링하여 이벤트를 검색할 수 있습니다. 
- 계정을 생성하면 자동으로 이벤트 히스토리에 접근할 수 있습니다. 
- 이벤트 히스토리를 조회하는 데는 비용이 발생하지 않습니다.

<br>

## 2.2 CloudTrail Lake

- AWS CloudTrail Lake는 감사 및 보안 목적으로 AWS의 사용자 및 API 활동을 캡처, 저장, 액세스 및 분석하기 위한 관리형 데이터 레이크입니다.
- CloudTrail Lake는 기존 이벤트를 행 기반 JSON 형식에서 Apache ORC 형식으로 변환합니다.
- ORC는 데이터의 빠른 검색을 최적화하는 열 기반 저장 형식입니다. 
- 이벤트는 선택한 기준에 따라 고급 이벤트 선택기를 적용하여 이벤트 데이터 저장소에 집계됩니다. 
- 이벤트 데이터는 최대 3,653일(약 10년) 동안 유지하거나, 최대 2,557일(약 7년) 동안 유지할 수 있습니다.
- CloudTrail Lake 이벤트 데이터 저장소 및 쿼리는 비용이 발생합니다. 
- 이벤트 데이터 저장소를 생성할 때 원하는 가격 옵션을 선택할 수 있습니다. 
- 가격 옵션은 이벤트를 수집하고 저장하는 비용 및 기본 및 최대 보존 기간을 결정합니다. 
- Lake에서 쿼리를 실행할 때 스캔된 데이터 양에 따라 비용이 부과됩니다.

<br>

## 2.3 트레일

- 트레일은 AWS 활동 기록을 캡처하여 Amazon S3 버킷에 이벤트를 전달하고 저장합니다. 
- CloudWatch Logs 및 Amazon EventBridge로의 전달도 옵션으로 제공합니다.
- 이러한 이벤트를 보안 모니터링 솔루션에 입력할 수 있습니다.
- 또한 Amazon Athena와 같은 타사 솔루션이나 솔루션을 사용하여 CloudTrail 로그를 검색하고 분석할 수 있습니다.
- 단일 AWS 계정 또는 AWS Organizations를 사용하여 여러 AWS 계정에 대한 트레일을 생성할 수 있습니다.
- Insights 이벤트를 기록하여 API 호출 볼륨 및 오류율의 이상 동작을 분석할 수 있습니다.
- 트레일을 생성하여 관리 이벤트의 하나의 복사본을 S3 버킷으로 전달하는 데 비용이 발생하지 않지만, Amazon S3 저장소 비용은 부과됩니다.

<br>

# 3 CloudTrail의 주요 기능

- CloudTrail은 보안 및 운영 모범 사례의 주요 측면인 AWS 계정 활동에 대한 가시성을 제공합니다. 
- CloudTrail을 사용하여 AWS 인프라 전반에 걸친 계정 활동을 조회, 검색, 다운로드, 아카이브, 분석 및 대응할 수 있습니다. 
- 누가 어떤 작업을 수행했는지, 어떤 리소스가 작동되었는지, 이벤트가 언제 발생했는지 등을 식별하여 계정 활동을 분석하고 대응할 수 있습니다.
- CloudTrail은 API를 사용하여 애플리케이션에 통합하고, 조직을 위한 트레일 또는 이벤트 데이터 저장소 생성을 자동화하며, 생성한 이벤트 데이터 저장소 및 트레일의 상태를 확인하고, 사용자가 CloudTrail 이벤트를 보는 방식을 제어할 수 있습니다.
