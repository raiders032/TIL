# 헥사고날 아키텍처

- 헥사고날 아키텍처라는 용어는 알리스테어 콕번이 만든 용어다.
	- 육각형 모양은 사실 아무 의미도 없다.
- 육각형 바깥에는 애플리케이션과 상호작용하는 다양한 어댑터들이 있다.
	- 웹 브라우저와 웹 어댑터도 있고, 일부 어댑터는 외부 시스템과 상호작용하며, 데이터베이스와 상호 작용하는 어댑터가 있다.
- 애플

<br>

## 패키지 구조

- 최상위에는 Account와 관련된 유스케이스를 구현한 모듈임을 나타내는 account 패키지가 있다.
- 그 다음 레벨에는 domain, application, adapter가 있다.
	- domain: 도메인 모델이 속함
	- application: 도메인 모델을 둘러싼 서비스 계층을 포함한다.
	- adapter: 애플리케이션 계층의 인커밍 포트를 호출하는 인커밍 어댑터와 애플리케이션 계층의 아웃고잉 포트에 대한 구현을 제공하는 아웃고잉 어댑터를 포함한다.

# 유스케이스

## 풍부한 도메인 모델

- DDD 철학을 따르는 풍부한 도메인 모델은 애플리케이션 코어에 있는 엔티티에서 가능한 많은 도메인 로직이 구현된다.
- 유스케이스는 도메인 모델의 진입점으로 동작한다.
- 유스케이스는 사용자의 의도만을 표현하면서 실제 작업은 체계화된 도메인 엔티티 메서드 호출로 변환한다.
- 많은 비즈니스 규칙이 유스케이스 구현체 대신 엔티티에 위치하게 된다.

<br>

## 빈약한 도메인 모델

- 빈약한 도메인 모델은 엔티티 자체가 굉장히 얇다.
- 엔티티 상태를 표현하는 필드와 이 값을 읽고 바꾸는 게터, 세터 메서드만 포함하고 어떤 도메인 로직도 가지고 있지 않다.
- 즉 도메인 로직이 유스케이스 클래스에 구현돼 있다는 것이다.
- 비즈니스 규칙을 검증하고, 엔티티의 상태를 바꾸고, 데이터베이스에 저장을 담당하는 책임이 유스케이스 클래스에 있다. 

<br>

## 유스케이스마다 다른 출력 모델

- 입력과 비슷하게 출력도 가능하면 각 유스케이스에 맞게 구체적인 것이 좋아.
	- 출력은 호출자에 꼭 필요한 데이터만 들고 있어야 한다.
- 유스케이스 간에 같은 출력 모델을 공유하게 되면 유스케이스들이 강하게 결합된다.
- 한 유스케이스에서 출력 모델에 새로운 필드를 추가하면 다른 유스케이스에서도 이 필드를 처리해야 한다.
- 단일 책임 원칙을 적용하고 모델을 분리해서 유지하는 것이 유스케이스 간의 결합도를 낮출 수 있다.


<br>

# 어댑터

- 애플리케이션 코어를 호출하면 주도하는 어댑터(driving adapter)라고 한다.
- 애플리케이션 코어에 의해 호출되는 어댑터를 주도되는 어댑터(driven adapter)라고 한다.

<br>

## 웹 어댑터의 책임

- HTTP 요청을 자바 객체로 매핑
- 권한 검사
- 입력 유효성 검증
- 입력을 유스케이스 입력 모델로 매핑
- 유스케이스 호출
- 유스케이스의 출력을 HTTP로 매핑
- HTTP 응답을 반환

<br>

## 컨트롤러의 크기

- 자바의 스프링 MVC 같은 대부분 웹 프레임워크는 앞서 논의한 책임을 수행하는 컨트롤러 클래스를 생성할 수 있다.
- 그럼 컨트롤러는 몇개 만들어야 될까? 너무 적은 것보다는 너무 많은 것이 좋다.
- 각 컨트롤러가 가능한 좁고 다른 컨트롤러와 가능한 적게 공유하는 웹 어댑터 조각을 구현해야 한다.