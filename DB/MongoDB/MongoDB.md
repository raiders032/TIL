# 1 MongoDB

- [레퍼런스](https://www.mongodb.com/docs/atlas/)
- 몽고디비는 관계형 데이터베이스가 아니라 도큐먼트 지향 데이터베이스다.
	- 주된 이유는 분산 확장(scale out)을 쉽게 하기 위함이다.
- 도큐먼트 지향 데이터베이스는 행 개념 대신 보다 유연한 모델인 도큐먼트를 사용한다.
	- 내장 도큐먼트와 배열을 허용해 복잡한 계층관계를 하나의 레코드로 표현할 수 있다.
	- 최신 객체 지향 언어를 사용하는 개발자의 관점에서 매우 적합하다.

<br>


# 2 도큐먼트

- 몽고디비의 핵심은 정렬된 키와 연결된 값의 집합으로 이뤄진 도큐먼트다.
- 도큐먼트의 표현 방식은 언어마다 다르다.
	- 맵, 해시, 딕셔너리와 같이 도큐먼트를 자연스럽게 표현하는 자료구조를 가진다.
	- 자바스크립트에서는 도큐먼를 객체로 표현한다.

<br>

## 2.1 키와 밸류의 데이터형

- 키는 문자열이다.
	- 아래 예외를 제외하면 어떤 UTF-8 문자든 사용할 수 있다.
	- 키는 `\0`를 포함하지 않는다.
	- `.`, `$` 문자는 몇가지 특별한 속성을 가지면 특정 상황에서만 사용할 수 있다

<br>

**값은 데이터형이어야 한다.**

```json
{
	"greeting": "Hello World",
	"views": 3
}
```

- greeting의 값은 문자열이다.
- views의 값은 정수다.

<br>

**몽고디비는 데이터형과 대소문자를 구별한다.**

```json
{
	"count" : 5
}
```

```json
{
	"Count": 5
}
```

- 예를 들어 위 두 도큐먼트는 서로 다르다.

<br>

**키가 중복될 수 없다.**

```json
{
	"greeting" : "Hello World",
	"greeting" : "Hello, MongoDB!"
}
```

- 따라서 위 도큐먼트는 올바른 도큐먼트가 아니다.

<br>

# 3 컬렉션

- 컬렉션은 도큐먼트의 모음이다.
	- 도큐먼트가 관계형 데이터베이스의 행에 대응된다면 컬렉션은 테이블에 대응된다.

<br>

## 3.1 동적 스키마

- 컬렉션은 동적 스키마를 가진다.
- 하나의 컬렉션 내 도큐먼트들이 모두 다른 구조를 가질 수 있다.
- 도큐먼트의 키, 키의 개수, 데이터형의 값은 모두 다르다.
- 다른 구조의 도큐먼트를 같은 컬렉션에 저장할 수 있다면 별도의 컬렉션이 필요한 이유에 대해서 의문을 품을 수 있다.
	- 컬렉션별로 목록을 뽑으면 한 컬렉션 내 특정 데이터형별로 쿼리해서 목록을 뽑을 떄보다 훨씬 빠르다.
	- 같은 종류의 데이터를 하나의 컬렉션에 모아두면 지역성에도 좋다.
	- 블로그 게시물을 여러 개를 뽑는 경우 게시물과 저자 정보가 섞인 컬렉션보다 게시글만 있는 컬렉션에 뽑을 때 디스크 탐색 시간이 짧아진다.
	- 인덱스를 만드려면 도큐먼트를 특정 구조를 가져야한다.

<br>

# 4 데이터베이스

- 몽고DB의 단일 인스턴스는 여러 데이터베이스를 호스팅할 수 있다.
- 데이터베이스는 하나 이상의 콜렉션을 포함하는 더 큰 컨테이너입니다. 
- 데이터베이스는 종종 애플리케이션 또는 서비스 단위로 구성됩니다. 
- 각 데이터베이스는 격리되어 있어 서로 다른 데이터베이스의 콜렉션 간에는 직접적인 관계가 없습니다.

<br>

# 5 데이터형

## 5.1 null

- `null` 타입은 값이 없음을 나타냅니다. 
- 필드가 명시적으로 비어있거나 존재하지 않는 경우에 사용됩니다. 
- 예를 들어, 어떤 사용자의 전화번호가 없는 경우 해당 필드는 `null`로 설정될 수 있습니다.

```json
{ "phone": null }
```

<br>

## 5.2 불리언

- 불리언(Boolean) 타입은 `true` 또는 `false` 값을 가집니다. 
- 이는 조건이 참인지 거짓인지를 나타내는 데 사용됩니다.

```json
{ "isActive": true }
```

<br>

## 5.3 숫자

- MongoDB는 다양한 숫자 타입을 지원합니다. 
- 기본적으로는 64비트 부동소수점 형식을 사용하지만, 정수 타입(32비트 및 64비트)도 지원합니다.

```json
{ "price": 19.99, "quantity": 10 }
```

<br>

## 5.4 문자열

- 문자열은 UTF-8 형식의 텍스트 데이터를 나타냅니다.

```json
{ "name": "John Doe", "greeting": "안녕하세요!" }
```

<br>

## 5.5 날짜

- 날짜 타입은 일자와 시간 정보를 나타냅니다. 
- MongoDB에서 날짜는 UNIX 시간 형태로 저장되며, 일반적으로 JavaScript의 `Date` 객체로 표현됩니다.
- 새로운 Date 객체를 생성할 때는 항상 `new Date()`를 호출해야 한다.
	- `Date()`는 객체가 아닌 날짜의 문자열 표현이 반환된다.
	- 문자열과 날짜는 일치하지 않으므로 주의해야 한다.

<br>

## 5.6 정규 표현식

- 정규 표현식 타입을 사용하여 텍스트 데이터에 대한 복잡한 검색 패턴을 정의할 수 있습니다. 
- 이를 통해 문자열 필드 내에서 특정 패턴을 쿼리할 수 있습니다.


<br



## 5.7 배열

- 배열 타입은 여러 값을 리스트 형태로 저장할 수 있습니다. 
- 배열 내의 각 항목은 동일하거나 다른 데이터 타입을 가질 수 있습니다.

```json
{ "tags": ["mongodb", "database", "noSQL"] }
```

<br>

## 5.8 내장 도큐먼트

- 내장 도큐먼트(Embedded documents)는 하나의 문서 내에 중첩된 도큐먼트를 표현합니다. 
- 이는 복잡한 계층적 데이터 구조를 구성하는 데 사용됩니다.

```json
{ 
	"address": { 
		"street": 
		"123 Main St", 
		"city": "New York", 
		"zip": "10001" 
	} 
}
```

<br>

## 5.9 ObjectId

- 객체 ID(ObjectId)는 문서의 고유 식별자입니다.
- 도큐먼트는 `_id` 키를 가지는데 해당 키의 값은 어떤 데에터형이어도 상관없지만 기본적으로 `ObjectId` 데이터형이다. 
- MongoDB에서는 대부분의 경우 자동으로 생성되며, 각 문서의 고유성을 보장합니다.


```json
{ "_id": ObjectId("507f191e810c19729de860ea") }
```

<br>

## 5.10 이진 데이터

- 이진 데이터(Binary data) 타입은 이미지, 파일 등의 이진 형태 데이터를 저장하는 데 사용됩니다.

<br>

## 5.11 코드

- MongoDB는 JavaScript 코드 조각도 저장할 수 있습니다. 
- 이를 통해 서버 사이드에서 실행할 수 있는 함수를 저장하고, 복잡한 연산을 수행할 수 있습니다.

<br>

# 일관성

- 몽고DB 데이터베이스에서 복제본 집합을 사용해 일관성 수준을 설정한다.
- 쓰기가 모든 슬레이브에 복제될 때까지 기다릴지, 아니면 주어진 수의 슬레이브가 복제될 때가지만 기다릴지 선택할 수 있다.
- 각 쓰기 명령마다 성공을 리턴하기 전에 쓰기를 전파해야 하는 서버 수를 지정할 수 있다.

